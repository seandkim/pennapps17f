<html>
<header>
  <title>Savage Bot</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</header>
<body>
  <span>Type your post here:</span>
  <br />
  <form>
    <!-- <input type="text" /> -->
    <textarea id='post' name=post cols="40" rows="5"></textarea>
    <br />
    <input type="submit" value="Submit">

    <br />
    <div class="result">

    </div>
  </form>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js'></script>
  <script>
    var temp;
    var socket = io();

    $(document).ready( function() {
      $('form').submit(function(e) {
        socket.emit('post_analyze', $('textarea#post').val());
        $('textarea#post').val('');

        return false; // prevent default action
      });

      // listen for result
      socket.on('post_result', function (results) {
        const keywords = results[0]['entities'];

        console.log("post result from client", keywords);

        // $('div.result').html("keywords: " + keywords)
        $('div.result').html("keywords: " + keywords.map(function(x) {return x['name']}))
      });
    });
  </script>

</body>
</html>
